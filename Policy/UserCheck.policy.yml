title: "User account security validation"
name: Drupal-8:UserLockDown
class: \Drutiny\Plugin\Drupal8\Audit\UserCheck
tags:
  - Drupal 8
  - Best Practice
  - Security
description: |
  Audit the security of a given user ID, scanning for and/or remediating
  simple account information whcih would otherwise be more secure.
remediation: "Change the username to be random, set the email address appropriately, set the password to something secure."
success: |
  User is locked down.
    - Username is set to {{username}}
    - Email is set to {{email}}
    - Status is set to {{status}}
    - If remediation took place, then the password has been updated.
warning: |
  User is not secure.
  {{#errors}}
    - {{ . }}
  {{/errors}}
failure: |
  User is not secure.
  {{#errors}}
    - {{ . }}
  {{/errors}}
parameters:
  blacklist:
    default: "(admin|root|drupal|god)"
    type: string
    description: |
      The usernames of the the given user that are considered forbidden.
      Expression maybe a regular expression to match patterns.
  uid:
    default: 1
    type: int
    description: |
      User Identifier (UID) of the given user to subject the assessment to.
  email:
    default: "no_reply@example.com"
    type: string
    description: |
      The email that the given user should have. If an empty string is provided
      then this check is omitted.
  status:
    default: 1
    type: boolean
    description: |
      Ensures the given user status reflects the same as this argument. Defaults
      to active (1).
